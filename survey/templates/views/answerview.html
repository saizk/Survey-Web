{% extends "base.html" %}

{% block content %}
    {% if current_user.is_authenticated %}
        <a href="{{url_for('views.display_public_survey', survey_hash=selected_survey.survey_hash)}}"><h2>Public link {{selected_survey.survey_hash}}</h2></a>
        <h1>Title: {{selected_survey.title}}</h1>
        <h2>Description: {{selected_survey.description}}</h2>
        {% for question, answers in info %}
            <h3>Question {{loop.index}}: {{question.statement}}</h3>
            <h4> Question type: {{question.question_type.name}}</h4>
            {% if answers %}
                <ul> {% for answer in answers %}
                    <li> {{answer.statement}}</li>
                    {% endfor %} </ul>
             {% endif %}
        {% endfor %}
    {% else %}
    
        <h1>Title: {{selected_survey.title}}</h1>
        <h2>Description: {{selected_survey.description}}</h2>

        <form method="POST" action="/{{selected_survey.survey_hash}}/answer">
            {% for question, answers in info %}
                <h3>Question {{loop.index}}: {{question.statement}}</h3>
                
                {% set q_num = loop.index %}
                {% if question.question_type.name == "OneAnswer" %}
                    <div>Select one:</div><br>
                    <div> {% for answer in answers %}
                         <input type="radio" id="ans{{loop.index}}" name="ans_q{{q_num}}" value="{{answer.statement}}">
                         <label for="ans{{loop.index}}">{{answer.statement}}</label><br>
                        {% endfor %} </div>

                {% elif question.question_type.name == "ManyAnswers" %}
                    <div>Select one or more:</div><br>
                    <div > {% for answer in answers %}
                        <input type="checkbox" id="ans{{loop.index}}" name="ans_q{{q_num}}" value="{{answer.statement}}">
                        <label for="ans{{loop.index}}">{{answer.statement}}</label><br>
                        {% endfor %} </div>

                {% elif question.question_type.name == "TextAnswer" %}
                    <div>Write: </div>
                    <textarea id="ans_q{{q_num}}" name="ans_q{{q_num}}"></textarea>

                {% elif question.question_type.name == "NumberAnswer" %}
                    <div>Select a number: <input type="number" id="ans_q{{q_num}}" name="ans_q{{q_num}}" min="{{1}}" max="{{100}}"></div>
                {% endif %}
            {% endfor %}
        <a href= "{{url_for('views.create_answer', survey_hash=selected_survey.survey_hash)}}">
            <button><input type="submit" value="Submit survey"/></button>
        </a>
        </form>
        
    {% endif %}
{% endblock %}